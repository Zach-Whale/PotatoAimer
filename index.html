<html>

<head>
  <title>Potato Aimer Squad</title>
  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <link rel="icon" href="content/potato_color_2.png">

  <script>

  $(document).ready(function()
  {

    var streamerNames = new Array();
    var onlineStreamers = new Array();
    var offlineStreamer = new Array();

    $.get("pages/streamers.txt", function(data){
      streamerNames = data.split("\n");


      streamerNames.map(streamerNames => {
        const twitchChannel =  'https://api.twitch.tv/kraken/channels/' + streamerNames,
        twitchStreams =  'https://api.twitch.tv/kraken/streams/' + streamerNames,
        twitchUsers = 'https://api.twitch.tv/helix/users?login=' + streamerNames;

        $.ajaxSetup({
          headers:{"Client-ID": "eu8zhc3k49ubec2brcpc824bhetvrk"}
        });
        $.getJSON(twitchChannel).done(channel => {
          if(channel.status === 404)
          {
            //printData("#", 'closed', offlineLogo, streamerNames, channel.message, 'event_busy', 0);
            return;
          }

          $.getJSON(twitchStreams).done(stream => {
            if(!stream.stream)
            {
              printDataUserOffline('offline', channel, stream.stream);
              return;
            }

            //printDataUserStreaming(channel.url, 'online', channel.logo, channel.display_name, channel.status, 'event_available', stream.stream.viewers, channel.status, stream.stream.game);
            printDataUserStreaming('online', channel, stream.stream);
          });

        });


        function printDataUserStreaming(userStatus, channelObject, streamObject)
        {
          $('#update').append(
            `<div class="streamer">
            <div class="streamer_name">${channelObject.display_name}</div>
            <div class="streamer_logo"><a href=${channelObject.url}><img class="user_image" src=${channelObject.logo}></img></a></div>
            <div class="streamer_views">Viewers: ${streamObject.viewers}</div>
            <div class="streamer_game">${streamObject.game}</div>
            <div class="streamer_title">${channelObject.status} !Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</div>
            <div class="streamer_description">!Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut</div>
            <div class="streamer_embed"><a href=${channelObject.url}><img src=${streamObject.preview.medium}></img></a></div>
            </div>`
          );

        }

        function printDataUserOffline(userStatus, channelObject, streamObject)
        {
          $('#update').append(
            `<div class="streamer">
            <div class="streamer_name_offline">${channelObject.display_name}</div>
            <div class="streamer_logo_offline"><a href=${channelObject.url}><img class="user_image" src=${channelObject.logo}></img></a></div>
            <div class="streamer_description_offline">!Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut</div>
            <div class="streamer_offline_message">${channelObject.display_name} is Offline!</div>
            </div>`
          );
        }

      });



    });
  });

  </script>

  <style>
  html
  {
    background-color: rgb(200 120 25);
  }
  .streamer
  {
    max-width: 900px;
    display: grid;
    margin-left: auto;
    margin-right: auto;
    border-width: 1px;
    border-style: solid;
    margin-top: 20px;
    background-color: white;
    border-radius: 10px;
    grid-auto-rows: minmax(100px auto;)
  }

  .streamer_name
  {
    grid-column: 1 / span 3;
    grid-row: 1;
    font-size: 2em;
    border-width: 1px;
    border-style: solid;
    /* margin: 10px 10px auto 10px; */
  }

  .streamer_logo
  {
    grid-column: 4 / span 2;
    grid-row: 1 / span 3;
    border-radius: 50%;
    border-style: solid;
    margin: auto;
  }
  .streamer_title
  {
    grid-column: 1 / span 3;
    grid-row: 3 / span 2;
    border-width: 1px;
    border-style: solid;
    /* max-width: 400px;
    margin: 10px; */
  }
  .streamer_views
  {
    grid-column: 1 / span 1;
    grid-row: 2;
    border-width: 1px;
    border-style: solid;
    /* margin: 10px auto 0px auto; */
  }

  .streamer_game
  {
    grid-column: 2 / span 2;
    grid-row: 2;
    border-width: 1px;
    border-style: solid;
    /* margin: auto; */
  }
  .streamer_description
  {
    grid-column: 1 / span 5;
    grid-row: 5 / span 2;
    border-width: 1px;
    border-style: solid;
    /* margin: 10px; */
  }
  .streamer_embed
  {
    grid-column: 6 / span 4;
    grid-row: 1 / span 6;
    border-width: 1px;
    border-style: solid;
    margin: auto;
  }

  #update
  {
    display:grid;
    grid-template-columns: 1;
  }

  .user_image
  {
    height: 75px;
    border-radius: 50%;
  }

  .streamer_name_offline
  {
    grid-column: 1 / span 2;
    grid-row: 1;
    font-size: 2em;

    border-width: 1px;
    border-style: solid;
  }
  .streamer_logo_offline
  {
    grid-column: 3 / span 2;
    grid-row: 1 / span 3;

    border-width: 1px;
    border-style: solid;
  }
  .streamer_description_offline
  {
    grid-column: 1 / span 2;
    grid-row: 2;
    border-width: 1px;
    border-style: solid;
  }
  .streamer_offline_message
  {
    grid-column: 1/ span 2;
    grid-row: 3;
    border-width: 1px;
    border-style: solid;
  }
</style>


</head>

<body>
  <div id="update">
  </div>
</body>

</html>
